<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIPI Matrizes</title>
    <link rel="stylesheet" href="styles/stylehomepage.css">
</head>

<body>
    <!-- Cabe√ßalho -->
    <header class="hero">
        <nav class="navbar">
            <a href="homepage.html" class="logo">
                <img src="assets/logo-vipi-sem-fundo.png" alt="Logo VIPI Matrizes">
            </a>

            <ul class="nav-links">
                <!-- ordem:entrar, cat√°logo, servi√ßos, estoque, contato, sair -->
                <li><a id="btn-login" href="#">Entrar</a></li>
                <li><a id="nav-catalog" href="index.html">Cat√°logo</a></li>
                <li><a id="nav-services" href="admin.html" class="hidden">Servi√ßos</a></li>
                <li><a id="nav-stock" href="estoque.html" class="hidden">Estoque</a></li>
                <li><a id="nav-contact" href="https://wa.me/5551995424598" target="_blank">Contato</a></li>
                <li><a id="btn-logout" href="#" class="hidden">Sair</a></li>
            </ul>
        </nav>

        <!-- Centralizado com <center> -->
        <center>
            <video autoplay muted loop playsinline
                style="width: 50%; margin-top: 20px; border: 10px solid #FFFFFF; border-radius: 50px;">
                <source src="assets/matrizvid.mp4" type="video/mp4">
                Seu navegador n√£o suporta v√≠deo.
            </video>
        </center>
    </header>


    <!-- Texto sobreposto ao v√≠deo -->
    <div class="hero-content">
        <h2>Bem-vindo √† <span>VIPI Matrizes</span></h2>
        <p>Qualidade e inova√ß√£o em usinagem de moldes para cal√ßados e estofamentos.</p>
    </div>
    </header>


    <!-- Se√ß√£o de servi√ßos -->
    <section id="servicos" class="services">
        <h2>Nossos Servi√ßos</h2>
        <div class="cards">
            <div class="card">
                <h3>Usinagem de Moldes</h3>
                <p>Alta precis√£o em moldes para cal√ßados e estofamentos.</p>
            </div>
            <div class="card">
                <h3>Manuten√ß√£o e Recupera√ß√£o</h3>
                <p>Realiza√ß√£o de reparos, ajustes e polimento em moldes e matrizes, prolongando sua vida √∫til e evitando
                    falhas.</p>
            </div>
            <div class="card">
                <h3>Consultoria T√©cnica</h3>
                <p>Disponibiliza√ß√£o da capacidade de usinagem da f√°brica para produzir pe√ßas espec√≠ficas, al√©m da
                    fabrica√ß√£o de matrizes.</p>
            </div>
        </div>
    </section>

    <!-- Se√ß√£o Hist√≥ria -->
    <section id="historia" class="history">
        <h2>Nossa Hist√≥ria</h2>
        <div class="container-history">

            <!-- Lado esquerdo com figuras -->
            <div class="img-lateral">
                <figure>
                    <img src="assets/familia.png" alt="Fam√≠lia fundadora">
                    <figcaption>Fam√≠lia fundadora</figcaption>
                </figure>
                <figure>
                    <img src="assets/funcionarios.png" alt="Funcion√°rios trabalhando">
                    <figcaption>Funcion√°rios trabalhando</figcaption>
                </figure>
            </div>

            <!-- Texto central -->
            <div class="text-history">
                <p>
                    A <strong>VIPI Matrizes</strong> nasceu em <strong>1998</strong>, no interior do Rio Grande do Sul,
                    fundada por
                    <strong>Fulano da Silva</strong>, um jovem empreendedor apaixonado por inova√ß√£o no setor cal√ßadista.
                    A empresa come√ßou de forma simples, em um pequeno galp√£o, com apenas duas m√°quinas de usinagem e
                    muita dedica√ß√£o.
                </p>
                <p>
                    Desde o in√≠cio, a miss√£o da VIPI foi oferecer <em>moldes de alta precis√£o para cal√ßados e
                        estofamentos</em>,
                    sempre unindo qualidade artesanal com o que havia de mais moderno em tecnologia de usinagem.
                    O nome ‚ÄúVIPI‚Äù surgiu da jun√ß√£o de <strong>Vis√£o, Inova√ß√£o, Precis√£o e Integra√ß√£o</strong>, valores
                    que guiam a empresa at√© hoje.
                </p>
                <p>
                    Nos anos 2000, a empresa ganhou destaque regional ao fornecer solu√ß√µes r√°pidas e personalizadas.
                    Em 2008, investiu em <strong>m√°quinas CNC de √∫ltima gera√ß√£o</strong>, ampliando a capacidade
                    produtiva e consolidando sua posi√ß√£o como refer√™ncia.
                </p>
                <p>
                    A partir de 2015, com o crescimento do mercado, a empresa iniciou a <strong>digitaliza√ß√£o de seus
                        processos</strong>,
                    criando sistemas internos para controle de estoque e gerenciamento de pedidos, trazendo mais
                    agilidade e transpar√™ncia para os clientes.
                </p>
                <p>
                    Hoje, a <strong>VIPI Matrizes</strong> atende empresas de todo o Brasil, sendo reconhecida pela
                    <strong>confiabilidade, inova√ß√£o e compromisso</strong>.
                    Al√©m da usinagem de moldes, oferece servi√ßos de cataloga√ß√£o digital, consultoria t√©cnica e solu√ß√µes
                    de gest√£o integrada.
                </p>
                <p>
                    O futuro da VIPI √© guiado pelo objetivo de se tornar uma <strong>empresa 100% digital e
                        sustent√°vel</strong>,
                    investindo em automa√ß√£o, redu√ß√£o de desperd√≠cios e em um cat√°logo online interativo que conecta
                    clientes diretamente aos servi√ßos oferecidos.
                </p>
                <p>
                    Mais do que uma ind√∫stria, a VIPI Matrizes √© a prova de que <strong>tradi√ß√£o e inova√ß√£o podem
                        caminhar juntas</strong>,
                    transformando ideias em solu√ß√µes de alto impacto para o setor cal√ßadista e de estofamentos.
                </p>
            </div>

            <!-- Lado direito com figuras -->
            <div class="img-lateral">
                <figure>
                    <img src="assets/fundador.png" alt="Fundador da empresa">
                    <figcaption>Fundador da empresa</figcaption>
                </figure>

                <figure>
                    <img src="assets/vipidentro.png" alt="Interior da VIPI">
                    <figcaption>Interior da VIPI</figcaption>
                </figure>
            </div>
        </div>
    </section>

    <!-- Se√ß√£o do Google Maps -->
    <section id="localizacao" class="maps">
        <h2> üìçNossa Localiza√ß√£o</h2>
        <p>
            Estamos localizados em Campo Bom - RS. Venha nos visitar e conhecer nossa estrutura moderna
            para usinagem de moldes com qualidade e inova√ß√£o.
        </p>
        <div class="map-container">
            <iframe
                src="https://www.google.com/maps/embed?pb=!4v1759370653753!6m8!1m7!1sJ0e3Iflw5D1kUWxJshMRYA!2m2!1d-29.68623884992533!2d-51.07091833666573!3f209.56195!4f0!5f0.7820865974627469"
                width="100%" height="400" style="border:0; border-radius: 10px;" allowfullscreen="" loading="lazy"
                referrerpolicy="no-referrer-when-downgrade">
            </iframe>
        </div>
    </section>


    <!-- Rodap√© -->
    <footer>
        <p>&copy; 2025 VIPI Matrizes. Todos os direitos reservados.</p>
    </footer>

    <!-- Modal de Login -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Login</h2>
            <form id="loginForm">
                <label for="email">E-mail</label>
                <input type="email" id="email" placeholder="Digite seu e-mail" required>

                <label for="password">Senha</label>
                <input type="password" id="password" placeholder="Digite sua senha" required>

                <button type="submit" class="btn">Entrar</button>
            </form>
        </div>
    </div>

    <!-- Script do modal + login Supabase -->
    <script type="module">
        // -------------------- refs DOM --------------------
        const modal = document.getElementById("loginModal");
        const btnOpen = document.getElementById("btn-login");
        const btnClose = document.querySelector(".close");
        const form = document.getElementById("loginForm");
        const email = document.getElementById("email");
        const password = document.getElementById("password");
        const btnSubmit = form?.querySelector('button[type="submit"]');

        // itens do menu
        const navServices = document.getElementById("nav-services");
        const navStock = document.getElementById("nav-stock");
        const btnLogin = document.getElementById("btn-login");
        const btnLogout = document.getElementById("btn-logout");

        // -------------------- carregar Supabase sob demanda --------------------
        let _sb = null;
        async function getSupabase() {
            if (_sb) return _sb;
            const mod = await import("./js/supabase/supabaseClient.js");
            _sb = mod?.supabase;
            if (!_sb) throw new Error("Supabase n√£o carregado");
            return _sb;
        }

        // -------------------- abrir/fechar modal --------------------
        function openModal(e) { e?.preventDefault(); modal.style.display = "flex"; }
        function closeModal() { modal.style.display = "none"; }
        btnOpen?.addEventListener("click", openModal);
        btnClose?.addEventListener("click", closeModal);
        window.addEventListener("click", (ev) => { if (ev.target === modal) closeModal(); });
        window.addEventListener("keydown", (ev) => { if (ev.key === "Escape") closeModal(); });

        // -------------------- regra de exibi√ß√£o do menu (apenas sess√£o) --------------------
        function applyMenu(logged) {
            // Entrar/Sair
            if (btnLogin) btnLogin.classList.toggle("hidden", !!logged);
            if (btnLogout) btnLogout.classList.toggle("hidden", !logged);

            // Se logou, mostra Servi√ßos e Estoque; sen√£o, esconde
            if (navServices) navServices.classList.toggle("hidden", !logged);
            if (navStock) navStock.classList.toggle("hidden", !logged);
        }

        async function updateMenuForCurrentSession() {
            try {
                const supabase = await getSupabase();
                const { data: { session } } = await supabase.auth.getSession();
                applyMenu(!!session);
            } catch (err) {
                console.error(err);
                applyMenu(false);
            }
        }

        // -------------------- login (submit do modal) --------------------
        form?.addEventListener("submit", async (e) => {
            e.preventDefault();

            const original = btnSubmit?.textContent;
            if (btnSubmit) { btnSubmit.disabled = true; btnSubmit.textContent = "Entrando..."; }

            try {
                const supabase = await getSupabase();
                const { error } = await supabase.auth.signInWithPassword({
                    email: email.value.trim(),
                    password: password.value
                });
                if (error) throw error;

                // sucesso: fecha modal e atualiza o menu (ficando na homepage)
                closeModal();
                await updateMenuForCurrentSession();
            } catch (err) {
                console.error(err);
                alert(err?.message || "Falha ao entrar");
            } finally {
                if (btnSubmit) { btnSubmit.disabled = false; btnSubmit.textContent = original || "Entrar"; }
            }
        });

        // -------------------- logout --------------------
        btnLogout?.addEventListener("click", async (e) => {
            e.preventDefault();
            try {
                const supabase = await getSupabase();
                await supabase.auth.signOut();
            } catch (err) {
                console.error(err);
            } finally {
                // volta ao estado p√∫blico sem redirecionar
                applyMenu(false);
            }
        });

        // -------------------- reagir a mudan√ßas de sess√£o (login/logout/refresh) --------------------
        getSupabase().then((sb) => {
            sb.auth.onAuthStateChange(() => {
                updateMenuForCurrentSession();
            });
        });

        // -------------------- boot --------------------
        updateMenuForCurrentSession();
    </script>
</body>

</html>